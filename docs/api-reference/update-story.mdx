---
title: 'update_story'
description: 'Regenerate a story while preserving any custom stories you have added'
---

## Overview

The `update_story` tool regenerates a story file from the latest component analysis, but unlike `generate_story` with `overwrite: true`, it **preserves any stories you have written by hand**.

When you run `update_story`, it:
1. Re-analyzes the component
2. Generates fresh content using the current template
3. Detects which stories already exist in the file
4. Appends any user-written stories that are not in the generated output
5. Validates imports before writing

<Info>
  `update_story` is a Pro feature. Free tier users should use `generate_story` with `overwrite: true`.
</Info>

## Parameters

<ParamField path="componentPath" type="string" required>
  Path to the component file relative to project root

  ```plaintext Example
  "src/components/Button.tsx"
  ```
</ParamField>

<ParamField path="includeVariants" type="boolean" default="true">
  Regenerate variant stories showcasing all size/variant combinations
</ParamField>

<ParamField path="includeInteractive" type="boolean" default="true">
  Regenerate play function tests for user interactions
</ParamField>

<ParamField path="includeA11y" type="boolean" default="false">
  Regenerate accessibility test story with axe-core checks
</ParamField>

<ParamField path="includeResponsive" type="boolean" default="false">
  Regenerate mobile/tablet/desktop viewport stories
</ParamField>

<ParamField path="template" type="string">
  Specific template to use (see [Templates](/templates/overview))

  Options: `basic`, `with-variants`, `with-msw`, `with-router`, `interactive`, `form`, `page`
</ParamField>

<ParamField path="dryRun" type="boolean" default="false">
  Preview the merged result without writing to disk
</ParamField>

## How merging works

The tool recognizes user-added stories by looking for exports that are not in the freshly generated content:

```tsx
// ─── User-added stories (preserved by update_story) ───
export const MyCustomScenario: Story = {
  args: { label: 'Edge case' },
}
```

Any `export const X: Story` block that was not generated by the tool is appended below a separator comment. The generated stories always appear first.

<Warning>
  Stories with the same name as generated stories will be replaced by the regenerated version. Rename your custom stories to avoid this.
</Warning>

## Examples

<CodeGroup>
```json Update with defaults
{
  "componentPath": "src/components/Button.tsx"
}
```

```json Preview merge result
{
  "componentPath": "src/components/Button.tsx",
  "dryRun": true
}
```

```json Update with specific template
{
  "componentPath": "src/components/UserList.tsx",
  "template": "with-msw"
}
```
</CodeGroup>

## Response

<ResponseField name="story" type="object">
  <Expandable title="Story object">
    <ResponseField name="content" type="string">
      Final merged story file content
    </ResponseField>
    <ResponseField name="filePath" type="string">
      Path where the story was written
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="preserved" type="array">
  Names of user-written stories that were preserved in the merge (e.g., `["MyCustomScenario"]`)
</ResponseField>

<ResponseField name="removed" type="array">
  Names of stories that existed before but were not preserved (usually empty)
</ResponseField>

<ResponseField name="written" type="boolean">
  Whether the file was written to disk (false if `dryRun: true`)
</ResponseField>

<ResponseField name="path" type="string">
  Path to the story file
</ResponseField>

<ResponseField name="validation" type="object">
  <Expandable title="Validation result">
    <ResponseField name="valid" type="boolean">
      Whether all imports resolved
    </ResponseField>
    <ResponseField name="warnings" type="array">
      Non-blocking warnings about imports or placeholders
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="summary" type="string">
  Human-readable summary including which stories were preserved
</ResponseField>

### Example response

```json
{
  "story": {
    "content": "...",
    "filePath": "src/components/Button.stories.tsx"
  },
  "preserved": ["MyCustomScenario", "DarkModeTest"],
  "removed": [],
  "written": true,
  "path": "src/components/Button.stories.tsx",
  "validation": {
    "valid": true,
    "warnings": []
  },
  "summary": "Updated story at src/components/Button.stories.tsx. Preserved user stories: MyCustomScenario, DarkModeTest"
}
```

## Version tracking

Every `update_story` call records an entry in `.forgekit/story-history.json`. Each entry includes:
- Story path and component path
- Action (`created`, `updated`, or `merged`)
- Timestamp and content hash

Up to 10 versions per story path are retained.

## Related tools

<CardGroup cols={2}>
  <Card title="generate_story" icon="wand-magic-sparkles" href="/api-reference/generate-story">
    Generate a story from scratch
  </Card>
  <Card title="validate_story" icon="check-circle" href="/api-reference/validate-story">
    Validate an existing story file
  </Card>
  <Card title="sync_component" icon="arrow-rotate-right" href="/api-reference/sync-component">
    Generate story + test + docs in one call
  </Card>
  <Card title="sync_all" icon="arrows-rotate" href="/api-reference/sync-all">
    Update all components at once
  </Card>
</CardGroup>
